# 오브젝트와 의존관계

## 스프링과 객체지향
스프링에서 가장 중요하게 생각하는 것은 객체지향 프로그래밍이다. 객체지향 기술의 진정한 가치를 회복시키고, 그로부터 객체지향 프로그래밍이 제공하는 폭넓은 혜택을 누릴 수 있도록 기본으로 돌아가자는 것이 스프링의 철학이다.

그래서 스프링에서 가장 관심을 많이 두는 대상은 오브젝트이다.

### 초난감 DAO(Data Access Object)
사용자 정보를 DB에 저장하고 조회할 수 있는 DAO를 만들어 보자
~~~Java
@Data
public class User {
  String id;
  String name;
  String password;
}
~~~
위와 같은 사용자 정보를 저장할 클래스를 만들고,
~~~Java
public class UserDao {
  public void add(User user) throws ClassNotFoundException, SQLException {
    Class.forName("com.mysql.jdbc.Driver");
    Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "id", "pw");

    PreparedStatement ps = c.preparedStatement(
    "insert into users(id, name, password) values(?, ?, ?)";
    );
    ps.setString(1, user.getId());
    ps.setString(2, user.getName());
    ps.setString(3, user.getPassword());

    ps.excuteUpdate();

    ps.close();
    c.close();
  }

  public User get(String id) throws ClassNotFoundException, SQLException {
    Class.forName("com.mysql.jdbc.Driver");
    Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "id", "pw");

    PreparedStatement ps = c.preparedStatement(
    "select * from users where id = ?"
    );
    ps.setString(1, id);

    ResultSet rs = ps.excuteQuery();
    rs.next();

    User user = new User();
    user.setId(rs.getString("id"));
    user.setName(rs.getString("name"));
    user.setPassword(rs.getString("password"));

    rs.close();
    ps.close();
    c.close();

    return user;
  }
}
~~~
DAO도 만들었다, 이제 제대로 동작하는지 확인하기 위해 테스트를 해야하는데 어떻게 할까?

### main()을 이용한 DAO 테스트 코드
만들어진 코드를 검증하고자 할때 가장 간단한 방법은 오브젝트 스스로 자신을 검증하도록 만들어주는 것이다. 모든 클래스에는 자신을 엔트리 포인트로 설정해 직접 실행이 가능하게 해주는 스태틱 메소드 main()이 있다.
UserDao 오브젝트를 생성해서 add()와 get()메소드를 검증해보자

~~~Java
public static voi main(String[] args) throws ClassNotFoundException, SQLException {
  UserDato dao = new UserDao();

  User user = new User();
  user.setId("retrokarr");
  user.setName("김광현");
  user.setPassword("retro");

  dao.add(user);

  System.out.println(user.getId() + " 등록 성공");

  User user2 = dao.get(user.getId());
  System.out.println(user2.getName());
  System.out.println(user2.getPassword());

  System.out.println(user2.getId() + " 조회 성공");
}

#retrokarr 등록 성공
#김광현
#retro
#retrokarr 조회 성공
~~~
main() 메소드를 실행하면 마지막 네줄의 성공 메세지를 얻을 수 있다.

이렇게 사용자 정보의 동록과 조회가 되는 DAO와 테스트용 메소드까지 완성했다. 그런데 이 코드에는 문제점이 많다. 그 문제점은 무엇일까 스스로 생각해보자.

- 왜 코드에 문제가 많다고 하는 것일까?
- DAO 코드를 개선했을때의 장점은 무엇일까?
- 그러한 장점들이 당장, 미래에 주는 이익은 무엇일까?

스프링을 공부한다는 건 이런 문제 제기와 의문에 대한 답을 찾아나가는 과정이다.

## DAO의 분리
### 관심사의 분리
프로그래밍 세계에서는 모든 것이 변한다. 단순히 변수나 오브젝트 필드의 값이 변한다는게 아니라, 오브젝트에 대한 설계와 이를 구현한 코드가 변한다는 뜻이다. 요구사항, 코드, 운영 환경 뿐만 아니라 기술 또한 시간이 지남에 따라 바뀐다.

그래서 개발자가 객체를 설계할 때 가장 염두에 둬야 할 사항은 미래의 변화를 어떻게 대비할 것인가이다. 그래야만 미래에 닥칠지 모르는 거대한 작업으로 인한 부담과 변경에 따른 스트레스, 갈등을 최소화할 수 있다.

미래를 준비하는 데 있어 가장 중요한 과제는 **변화에 어떻게 대비할 것인가** 이며, 가장 좋은 대책은 **변화의 폭을 최소한으로 줄여주는 것** 이다.

> 객체지향의 의미는 객체지향 기술이 만들어내는 가상의 추상세계 자체를 효과적으로 구성할 수 있고, 이를 자유롭고 편리하게 변경,발전, 확장시킬 수 있다는 데 더 의미가 있다.

어떻게 변경이 일어날 때 필요한 작업을 최소화하고, 그 변경이 다른 곳에 문제를 일으키지 않게 할 수 있을까? 그것은 *분리와 확장* 을 고려한 설계를 했을때 가능하다.

모든 변경과 발전은 한 번에 한 가지 관심사항에 집중해서 일어난다, 분제는 변화는 대체로 집중된 한 가지 관심에 대해 일어나지만 그에 따른 작업은 할 곳에 집중되지 않는 경우가 많다는 점이다.

변화가 한 번에 한 가지 관심에 집중돼서 일어난다면, 우리가 준비해야 할 일은 한 가지 관심이 한 군데에 집중되게 하는 것이다. 관심이 같은 것끼리는 모으고, 관심이 다른 것은 따로 떨어져 있게 하는 것이다.

> 관심사의 분리 관심이 같은 것끼리는 하나의 객체 안으로 또는 친한 객체로 모이게 하고, 관심이 다른 것은 가능한 한 따로 떨어져서 서로 영향을 주지 않도록 분리하는 것.
